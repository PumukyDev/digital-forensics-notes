<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html">

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.09.25 -->
        <title>PRACTICE 2 — NTFS ANALYSIS - Forensics PXE Station 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #254F6D;
  --color-brand-content: #254F6D;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Forensics PXE Station 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Content:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="exercise1.html">PRACTICE 1 — STATEMENT</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise1.html#practice-1-solution">PRACTICE 1 — SOLUTION</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/practica2.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="practice-2-ntfs-analysis">
<h1>PRACTICE 2 — NTFS ANALYSIS<a class="headerlink" href="#practice-2-ntfs-analysis" title="Link to this heading">¶</a></h1>
<p>The file system on any storage device is essential for the overall organization, storage mechanisms, and data control of the device. Understanding how these file systems work, as well as the design of key structures, storage mechanisms, associated metadata, and file system features, is crucial for conducting forensic investigations on a computer or other device.</p>
<p>NTFS and FAT file systems are two widely used and commonly encountered systems. Both offer significant and mandatory forensic evidence in any investigation.</p>
<section id="main-objective-of-the-practice">
<h2>Main Objective of the Practice<a class="headerlink" href="#main-objective-of-the-practice" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Study the metadata provided by the NTFS file system for forensic analysis.</p></li>
</ul>
</section>
<section id="software-to-use">
<h2>Software to Use<a class="headerlink" href="#software-to-use" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>FTK Imager 4.3 or higher</p></li>
<li><p>Active Disk Editor v7.0</p></li>
<li><p>MFT2Csv</p></li>
<li><p>NTFSLogFile</p></li>
<li><p>UsnJrl2Csv</p></li>
<li><p>ANJP</p></li>
<li><p>AlternateStreamViewer</p></li>
<li><p>Indx2Csv</p></li>
</ul>
<p><strong>Disk image to use:</strong> Download it from the provided link.</p>
</section>
<section id="tasks">
<h2>Tasks<a class="headerlink" href="#tasks" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Download the disk image and open it with Active Disk Editor (ADE). Try to identify, using ADE and by inspecting the 1 KB MFT records, which of them have been deleted based on the <strong>FLAGS</strong> property (<code class="docutils literal notranslate"><span class="pre">in</span> <span class="pre">use</span> <span class="pre">=</span> <span class="pre">0</span></code>).
a. Locate any entry corresponding to a deleted file (for example, “texto - copia.txt”), and take a screenshot. Memory position hint: go to position <code class="docutils literal notranslate"><span class="pre">03397XXXX</span></code>.<br />
b. Recover the file using FTK Imager (found in the Recycle Bin folder).</p></li>
<li><p>Identify low-level attributes of one of the files (MFT records) using Active Disk Editor 7. The attributes of interest are <strong>$10</strong>, <strong>$30</strong>, and <strong>$80</strong>.<br />
a. Where can you find the creation, modification, and access dates?<br />
b. What does the <strong>non-resident</strong> property mean, and what are the values 0/1 associated with it?</p></li>
<li><p>Export the <strong>$MFT</strong> metadata file using FTK, process it with MFT2CSV, and import it into a spreadsheet editor to analyze the attributes. The goal is to study which files were deleted and when. Filter by the field <strong>“in use = 0”</strong> (deleted) and/or by <strong>RecordActive = DELETED/ALLOCATED</strong> to obtain the deletion date/time.</p></li>
<li><p>Export the <strong>$LogFILE</strong> metadata file. Together with the $MFT from the previous step, it provides information about file system transactions. Process the files using <strong>NTFSLogFile Parse</strong> to decode the information and obtain a CSV.</p>
<ul class="simple">
<li><p>Search for transactions where <strong>lf_RedoOperation = DeallocateFileRecordSegment</strong> to locate files that were permanently deleted, since this operation deallocates the file record segment.</p></li>
</ul>
</li>
<li><p>Export the metadata file corresponding to <strong>$USNJournal</strong><br />
(<code class="docutils literal notranslate"><span class="pre">$Extend</span> <span class="pre">-&gt;</span> <span class="pre">$USNjrl</span> <span class="pre">-&gt;</span> <span class="pre">$J</span></code>).<br />
Process it using <strong>UsnJrl2Csv</strong> to decode its stored information.</p>
<ul class="simple">
<li><p>Filter the resulting data by <strong>Reason = CLOSE+DELETE</strong> to obtain the timestamps of permanent file deletions.</p></li>
</ul>
</li>
<li><p>Use the <strong>ANJP</strong> tool to perform a combined analysis of <strong>$MFT</strong>, <strong>$LogFile</strong>, and <strong>$USNJournal</strong>.<br />
You will see that it processes the same information as the previous sections but in an integrated way. It includes a <strong>Parse</strong> tab and a <strong>Report</strong> tab.</p>
<ul class="simple">
<li><p>Use the tool and take a couple of screenshots of the generated report.<br />
<em>(Note: This is a paid tool.)</em></p></li>
</ul>
</li>
<li><p>Use <strong>FTK Imager</strong> and <strong>AlternateDataViewer</strong> to study the origin of the files found in the <code class="docutils literal notranslate"><span class="pre">datos.dd</span></code> image.</p>
<ul class="simple">
<li><p>Take a screenshot with each tool showing one example.</p></li>
</ul>
</li>
<li><p>Export the directory index metadata files (<strong>$I30</strong>) for the three directories present in the <code class="docutils literal notranslate"><span class="pre">datos.dd</span></code> disk image:</p>
<ul class="simple">
<li><p>the root directory,</p></li>
<li><p>the directory named “carpeta”,</p></li>
<li><p>and the Recycle Bin directory.<br />
Process these files with <strong>Indx2Csv</strong>.</p></li>
<li><p>Analyze which files exist now and which existed in the past in each directory.</p></li>
</ul>
</li>
<li><p>Install the automated file recovery tool <strong>Recuva</strong>.<br />
Mount the <code class="docutils literal notranslate"><span class="pre">datos.dd</span></code> disk image with <strong>FTK Imager</strong> and use Recuva to recover as many files as possible.</p>
<ul class="simple">
<li><p>Compare the recovered files with those that FTK Imager is able to recover (marked with the deletion cross icon).</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section id="practice-1-complete-solution">
<h1>Practice 1 – Complete Solution<a class="headerlink" href="#practice-1-complete-solution" title="Link to this heading">¶</a></h1>
<p><strong>Disk Forensics with Active Disk Editor, FTK Imager and NTFS Analysis Tools</strong></p>
<hr class="docutils" />
<section id="section-1">
<h2>Section 1<a class="headerlink" href="#section-1" title="Link to this heading">¶</a></h2>
<section id="statement">
<h3>Statement<a class="headerlink" href="#statement" title="Link to this heading">¶</a></h3>
<p>Download the disk image and open it with Active Disk Editor (ADE). Using ADE, and by inspecting the MFT records (1 KB), identify which entries have been deleted based on the FLAGS property (“in use” = 0).</p>
<p>a) Locate any entry corresponding to a deleted file. For example: “texto - copia.txt”. Make a screenshot. Memory position hint: go to address <code class="docutils literal notranslate"><span class="pre">03397XXXX</span></code>.</p>
<p>b) Recover the file using FTK Imager (found inside the “papelera” folder).</p>
</section>
<section id="solution">
<h3>Solution<a class="headerlink" href="#solution" title="Link to this heading">¶</a></h3>
<p>We start by opening Active Disk Editor and locating our device. To inspect the disk, we click <strong>Open in File Browser</strong>, which allows us to look at the files without mounting the drive. However, the file is indicated as deleted.</p>
<p>To search for the deleted file, we must right-click and select <strong>Edit</strong>.</p>
<p>Inside the editor, we use the search function (Right-Click → <strong>Find</strong>, or Ctrl + F). I noticed that ADE displays ASCII characters separated by dots, so I searched for:<br />
<code class="docutils literal notranslate"><span class="pre">t.e.x.t.o.</span> <span class="pre">.-.</span> <span class="pre">.c.o.p.i.a...t.x.t.</span></code> and clicked <strong>Find ALL</strong>.</p>
<p>At the bottom left, ADE displays all matches. I checked each result until finding one whose sector begins with <code class="docutils literal notranslate"><span class="pre">FILE0</span></code>, which indicates the start of an MFT entry.<br />
<strong>Reminder:</strong> set the template to <strong>NTFS MFT File Record</strong> and position the cursor at the start of <code class="docutils literal notranslate"><span class="pre">FILE0</span></code>.</p>
<p>Once the file is identified, we check the FLAGS attribute. Since the “in use” flag is unset, the file is confirmed as deleted.</p>
<p>Next, to recover the file, we must CLOSE Active Disk Editor because it conflicts with FTK Imager. Then we mount the disk (or load it as an image). I mounted the image for easier reading:</p>
<ul class="simple">
<li><p><strong>Image mounting → Select File</strong></p></li>
</ul>
<p>Then:</p>
<ul class="simple">
<li><p><strong>Add Evidence Item → Physical Drive → (the last detected drive)</strong></p></li>
</ul>
<p>We browse the contents until we find <code class="docutils literal notranslate"><span class="pre">texto</span> <span class="pre">-</span> <span class="pre">copia.txt</span></code> under:<br />
<strong>Datos → Root → Carpeta</strong></p>
<p>The file appears with a red cross meaning it was deleted.</p>
<p>To recover it:</p>
<ol class="arabic simple">
<li><p>Right-click the file</p></li>
<li><p>Select <strong>Export Files</strong></p></li>
<li><p>Choose the destination folder</p></li>
<li><p>Confirm</p></li>
</ol>
<p>The file is successfully exported and recovered.</p>
</section>
</section>
<hr class="docutils" />
<section id="section-2">
<h2>Section 2<a class="headerlink" href="#section-2" title="Link to this heading">¶</a></h2>
<section id="id1">
<h3>Statement<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>Identify low-level attributes of an MFT record using ADE. We focus on attributes $10, $30 and $80.</p>
<p>a) Where are creation, modification and access timestamps stored?<br />
b) What does “non-resident” mean and what do the values 0/1 represent?</p>
</section>
<section id="id2">
<h3>Solution<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>With the file entry selected (<code class="docutils literal notranslate"><span class="pre">FILE0</span></code>) and the template set to <strong>NTFS MFT File Record</strong>:</p>
<ul class="simple">
<li><p><strong>Attribute $10 (Standard Information)</strong> contains:</p>
<ul>
<li><p>Creation time</p></li>
<li><p>Last modification time</p></li>
<li><p>Last access time</p></li>
<li><p>Owner and security data</p></li>
<li><p>Other metadata</p></li>
</ul>
</li>
<li><p><strong>Attribute $30 (File Name)</strong> contains:</p>
<ul>
<li><p>File name</p></li>
<li><p>Flags (hidden, system, etc.)</p></li>
<li><p>Additional timestamps</p></li>
</ul>
</li>
<li><p><strong>Attribute $80 (Data)</strong> contains:</p>
<ul>
<li><p>File data (if resident)</p></li>
<li><p>Data runs (if non-resident)</p></li>
</ul>
</li>
</ul>
<p><strong>Answers:</strong></p>
<p>a) Timestamps for creation, modification and access are stored in <strong>attribute $10</strong>.<br />
b) <strong>Non-resident = 1</strong> means file content is stored <em>outside</em> the MFT entry.<br />
<strong>Non-resident = 0</strong> means the file’s content is stored <em>inside</em> the MFT record (resident).</p>
</section>
</section>
<hr class="docutils" />
<section id="section-3">
<h2>Section 3<a class="headerlink" href="#section-3" title="Link to this heading">¶</a></h2>
<section id="id3">
<h3>Statement<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>Export the <code class="docutils literal notranslate"><span class="pre">$MFT</span></code> file using FTK Imager, process it with <strong>MFT2CSV</strong>, and import it into a spreadsheet. Filter the results by “in use = 0” and/or “RecordActive = DELETED/ALLOCATED” to determine deleted files and their timestamps.</p>
</section>
<section id="id4">
<h3>Solution<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>Using FTK Imager, we extract the <code class="docutils literal notranslate"><span class="pre">$MFT</span></code> file from the Evidence Tree (same method as in Section 1).</p>
<p>We download <strong>MFT2CSV</strong> from GitHub. After opening it:</p>
<ul class="simple">
<li><p>We select the disk image path</p></li>
<li><p>We change the output separator for easier reading (recommended: semicolon <code class="docutils literal notranslate"><span class="pre">;</span></code>)</p></li>
<li><p>We select an output directory</p></li>
<li><p>We run the conversion</p></li>
</ul>
<p>The output includes many files; the correct one is highlighted in green by the tool.</p>
<p>We open the CSV with OpenOffice and enable:<br />
<strong>Data → Filter → AutoFilter</strong></p>
<p>Then we filter:</p>
<ul class="simple">
<li><p>Column <strong>M</strong> = deleted<br />
or</p></li>
<li><p>Column <strong>RecordActive = DELETED</strong></p></li>
</ul>
<p>This reveals the list of deleted files and their deletion timestamps.</p>
</section>
</section>
<hr class="docutils" />
<section id="section-4">
<h2>Section 4<a class="headerlink" href="#section-4" title="Link to this heading">¶</a></h2>
<section id="id5">
<h3>Statement<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>Export <code class="docutils literal notranslate"><span class="pre">$LogFile</span></code> and process it using <strong>NTFSLogFile Parser</strong>. Look for entries where <code class="docutils literal notranslate"><span class="pre">lf_RedoOperation</span> <span class="pre">=</span> <span class="pre">DeallocateFileRecordSegment</span></code>, which indicates permanent deletion of a file record.</p>
</section>
<section id="id6">
<h3>Solution<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>We extract <code class="docutils literal notranslate"><span class="pre">$LogFile</span></code> using FTK Imager as before.</p>
<p>In NTFSLogFile Parser:</p>
<ul class="simple">
<li><p>Select <code class="docutils literal notranslate"><span class="pre">$LogFile</span></code></p></li>
<li><p>Select the previously exported <code class="docutils literal notranslate"><span class="pre">$MFT</span></code></p></li>
<li><p>Set separator to <code class="docutils literal notranslate"><span class="pre">;</span></code></p></li>
<li><p>Choose an output directory</p></li>
<li><p>Click <strong>Start</strong></p></li>
</ul>
<p>The tool generates a folder containing <code class="docutils literal notranslate"><span class="pre">LogFile.csv</span></code>.<br />
Open it in OpenOffice and set the separator to <code class="docutils literal notranslate"><span class="pre">|</span></code>.</p>
<p>Filter:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lf_RedoOperation</span> <span class="pre">=</span> <span class="pre">DeallocateFileRecordSegment</span></code></p></li>
</ul>
<p>The resulting entries correspond to files whose MFT record segment was permanently deallocated—i.e., definitively deleted.</p>
</section>
</section>
<hr class="docutils" />
<section id="section-5">
<h2>Section 5<a class="headerlink" href="#section-5" title="Link to this heading">¶</a></h2>
<section id="id7">
<h3>Statement<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<p>Export <code class="docutils literal notranslate"><span class="pre">$USNJournal</span></code> (<code class="docutils literal notranslate"><span class="pre">$Extend</span> <span class="pre">→</span> <span class="pre">$USNjrl</span> <span class="pre">→</span> <span class="pre">$J</span></code>) and process it using <strong>UsnJrl2Csv</strong>. Filter the result by <code class="docutils literal notranslate"><span class="pre">Reason</span> <span class="pre">=</span> <span class="pre">CLOSE+DELETE</span></code> to find the timestamps of final deletions.</p>
</section>
<section id="id8">
<h3>Solution<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<p>We extract <code class="docutils literal notranslate"><span class="pre">$J</span></code> using FTK Imager.</p>
<p>With UsnJrl2Csv:</p>
<ul class="simple">
<li><p>Set separator to <code class="docutils literal notranslate"><span class="pre">;</span></code></p></li>
<li><p>Set output directory</p></li>
<li><p>Click <strong>Start</strong></p></li>
</ul>
<p>Open the resulting CSV and set separator to semicolon.</p>
<p>Filter:</p>
<ul class="simple">
<li><p>Column <strong>Reason = CLOSE+DELETE</strong></p></li>
</ul>
<p>This shows the exact time when each file was deleted and the handle closed.</p>
</section>
</section>
<hr class="docutils" />
<section id="section-6">
<h2>Section 6<a class="headerlink" href="#section-6" title="Link to this heading">¶</a></h2>
<section id="id9">
<h3>Statement<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<p>Use <strong>ANJP</strong>, which processes <code class="docutils literal notranslate"><span class="pre">$MFT</span></code>, <code class="docutils literal notranslate"><span class="pre">$LogFile</span></code> and <code class="docutils literal notranslate"><span class="pre">$USNJournal</span></code> together. Provide a couple screenshots of its report view.</p>
</section>
<section id="id10">
<h3>Solution<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<p>ANJP integrates all previous tools. After launching it:</p>
<ol class="arabic simple">
<li><p>Enter a case name</p></li>
<li><p>Select an output directory</p></li>
<li><p>Load:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$MFT</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$LogFile</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$USNJournal</span></code></p></li>
</ul>
</li>
<li><p>Click <strong>Parse</strong></p></li>
</ol>
<p>Once processed, go to <strong>Reports</strong>, where the tool displays all combined analysis.</p>
<p>For example:<br />
<strong>LogFile → File Interactions</strong> shows detailed activity for <code class="docutils literal notranslate"><span class="pre">texto</span> <span class="pre">-</span> <span class="pre">copia.txt</span></code>.</p>
</section>
</section>
<hr class="docutils" />
<section id="section-7">
<h2>Section 7<a class="headerlink" href="#section-7" title="Link to this heading">¶</a></h2>
<section id="id11">
<h3>Statement<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<p>Use FTK Imager and AlternateDataViewer to study the origin of the files in “datos.dd”. Provide one screenshot from each tool.</p>
</section>
<section id="id12">
<h3>Solution<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<p>In FTK Imager:</p>
<ol class="arabic simple">
<li><p>Add Evidence Item → Physical Drive → Select the mounted disk</p></li>
<li><p>Open the partition</p></li>
<li><p>Browse to any file, e.g., <code class="docutils literal notranslate"><span class="pre">Proyecto</span> <span class="pre">Educativo.pdf</span></code></p></li>
</ol>
<p>Next to the file, we see an alternate stream:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Zone.Identifier</span></code><br />
Opening it reveals:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ZoneID=3</span></code> → File downloaded from Internet Explorer</p></li>
</ul>
</li>
</ul>
<p>Using <strong>AlternateStreamView</strong>:</p>
<ol class="arabic simple">
<li><p>Select the target directory (e.g., the partition root)</p></li>
<li><p>It lists all files with ADS streams</p></li>
<li><p>Double-clicking <code class="docutils literal notranslate"><span class="pre">Proyecto</span> <span class="pre">Educativo.pdf</span></code> shows its ADS metadata</p></li>
<li><p>Extracting the ADS (Right-click → Extract Stream) allows reading it in plain text</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="section-8">
<h2>Section 8<a class="headerlink" href="#section-8" title="Link to this heading">¶</a></h2>
<section id="id13">
<h3>Statement<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<p>Export the directory index metadata <code class="docutils literal notranslate"><span class="pre">$I30</span></code> for the three directories in “datos.dd”:</p>
<ul class="simple">
<li><p>root</p></li>
<li><p>carpeta</p></li>
<li><p>recycle bin</p></li>
</ul>
<p>Process them with <strong>Indx2Csv</strong> and analyze which files exist or previously existed.</p>
</section>
<section id="id14">
<h3>Solution<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<p>Using FTK Imager, we extract:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$I30</span></code> from <strong>carpeta</strong></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$I30</span></code> from <strong>root</strong></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$I30</span></code> from the Recycle Bin subdirectory</p></li>
</ul>
<p>Then with <strong>Indx2Csv</strong>, for each <code class="docutils literal notranslate"><span class="pre">$I30</span></code>:</p>
<ul class="simple">
<li><p>Set file path</p></li>
<li><p>Set output directory</p></li>
<li><p>Click <strong>Start</strong></p></li>
</ul>
<p>Each output is a <code class="docutils literal notranslate"><span class="pre">.csv</span></code>, which we open with OpenOffice.</p>
<p>Findings:</p>
</section>
<section id="directory-carpeta">
<h3>Directory “carpeta”<a class="headerlink" href="#directory-carpeta" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Six entries appear</p></li>
<li><p>Three correspond to <code class="docutils literal notranslate"><span class="pre">texto.txt</span></code>, repeated because the file was opened or modified multiple times</p></li>
<li><p>We can analyze timestamps and deletion history</p></li>
</ul>
</section>
<section id="root">
<h3>Root<a class="headerlink" href="#root" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Contains visible files and hidden/system files</p></li>
<li><p>Shows creation, modification, and deletion metadata</p></li>
</ul>
</section>
<section id="recycle-bin">
<h3>Recycle Bin<a class="headerlink" href="#recycle-bin" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Contains many entries corresponding to deleted files</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="section-9">
<h2>Section 9<a class="headerlink" href="#section-9" title="Link to this heading">¶</a></h2>
<section id="id15">
<h3>Statement<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<p>Install <strong>Recuva</strong>, mount “datos.dd” with FTK Imager, and use Recuva to recover as many files as possible. Compare results with the deleted-file list in FTK Imager.</p>
</section>
<section id="id16">
<h3>Solution<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<p>With Recuva:</p>
<ol class="arabic simple">
<li><p>Select the drive corresponding to the mounted image (e.g., G:)</p></li>
<li><p>Click <strong>Next</strong></p></li>
<li><p>Recuva scans and displays recoverable files</p></li>
<li><p>Select all files</p></li>
<li><p>Click <strong>Recover</strong> and choose a destination folder</p></li>
</ol>
<p>Recuva successfully recovers all selected files.</p>
<p>Comparison with FTK Imager:</p>
<ul class="simple">
<li><p>FTK Imager shows <code class="docutils literal notranslate"><span class="pre">calendarioSept2018.pdf</span></code> in the Root folder</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">texto</span> <span class="pre">-</span> <span class="pre">copia.txt</span></code> is visible in the “carpeta” folder as deleted</p></li>
<li><p>Other recovered files match Recuva’s output, although some lack clear source information</p></li>
</ul>
<hr class="docutils" />
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, PumukyDev
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">PRACTICE 2 — NTFS ANALYSIS</a><ul>
<li><a class="reference internal" href="#main-objective-of-the-practice">Main Objective of the Practice</a></li>
<li><a class="reference internal" href="#software-to-use">Software to Use</a></li>
<li><a class="reference internal" href="#tasks">Tasks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#practice-1-complete-solution">Practice 1 – Complete Solution</a><ul>
<li><a class="reference internal" href="#section-1">Section 1</a><ul>
<li><a class="reference internal" href="#statement">Statement</a></li>
<li><a class="reference internal" href="#solution">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-2">Section 2</a><ul>
<li><a class="reference internal" href="#id1">Statement</a></li>
<li><a class="reference internal" href="#id2">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-3">Section 3</a><ul>
<li><a class="reference internal" href="#id3">Statement</a></li>
<li><a class="reference internal" href="#id4">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-4">Section 4</a><ul>
<li><a class="reference internal" href="#id5">Statement</a></li>
<li><a class="reference internal" href="#id6">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-5">Section 5</a><ul>
<li><a class="reference internal" href="#id7">Statement</a></li>
<li><a class="reference internal" href="#id8">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-6">Section 6</a><ul>
<li><a class="reference internal" href="#id9">Statement</a></li>
<li><a class="reference internal" href="#id10">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-7">Section 7</a><ul>
<li><a class="reference internal" href="#id11">Statement</a></li>
<li><a class="reference internal" href="#id12">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-8">Section 8</a><ul>
<li><a class="reference internal" href="#id13">Statement</a></li>
<li><a class="reference internal" href="#id14">Solution</a></li>
<li><a class="reference internal" href="#directory-carpeta">Directory “carpeta”</a></li>
<li><a class="reference internal" href="#root">Root</a></li>
<li><a class="reference internal" href="#recycle-bin">Recycle Bin</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-9">Section 9</a><ul>
<li><a class="reference internal" href="#id15">Statement</a></li>
<li><a class="reference internal" href="#id16">Solution</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=01f34227"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>