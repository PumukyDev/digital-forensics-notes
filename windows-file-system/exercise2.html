<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html">

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.12.19 -->
        <title>Exercise 2 - Digital Forensics Notes 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #254F6D;
  --color-brand-content: #254F6D;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Digital Forensics Notes 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Content:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exercise1.html">Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercise2.html">Exercise 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercise3.html">Exercise 3</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/windows-file-system/exercise2.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="exercise-2">
<h1>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading">¶</a></h1>
<p>The file system on any storage device is essential for the overall organization, storage mechanisms, and data control of the device. Understanding how these file systems work, as well as the design of key structures, storage mechanisms, associated metadata, and file system features, is crucial for conducting forensic investigations on a computer or other device.</p>
<p>NTFS and FAT file systems are two widely used and commonly encountered systems. Both offer significant and mandatory forensic evidence in any investigation.</p>
<section id="main-objective-of-the-practice">
<h2>Main Objective of the Practice<a class="headerlink" href="#main-objective-of-the-practice" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Study the metadata provided by the NTFS file system for forensic analysis.</p></li>
</ul>
</section>
<section id="software-to-use">
<h2>Software to Use<a class="headerlink" href="#software-to-use" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>FTK Imager 4.3 or higher</p></li>
<li><p>Active Disk Editor v7.0</p></li>
<li><p>MFT2Csv</p></li>
<li><p>NTFSLogFile</p></li>
<li><p>UsnJrl2Csv</p></li>
<li><p>ANJP</p></li>
<li><p>AlternateStreamViewer</p></li>
<li><p>Indx2Csv</p></li>
</ul>
<p><strong>Disk image to use:</strong> Download it from <a class="reference download internal" download="" href="../_downloads/60e7072a053c49abae9cb33ae3c6e4c0/disk2.7z"><span class="xref download myst">here</span></a>.</p>
</section>
<section id="section-1">
<h2>Section 1<a class="headerlink" href="#section-1" title="Link to this heading">¶</a></h2>
<section id="statement">
<h3>Statement<a class="headerlink" href="#statement" title="Link to this heading">¶</a></h3>
<p>Download the disk image and open it with Active Disk Editor (ADE). Try to identify, using ADE and by inspecting the 1 KB MFT records, which of them have been deleted based on the <strong>FLAGS</strong> property (<code class="docutils literal notranslate"><span class="pre">in</span> <span class="pre">use</span> <span class="pre">=</span> <span class="pre">0</span></code>).
a. Locate any entry corresponding to a deleted file (for example, “texto - copia.txt”), and take a screenshot. Memory position hint: go to position <code class="docutils literal notranslate"><span class="pre">03397XXXX</span></code>.<br />
b. Recover the file using FTK Imager (found in the Recycle Bin folder).</p>
</section>
<section id="solution">
<h3>Solution<a class="headerlink" href="#solution" title="Link to this heading">¶</a></h3>
<p>If we open Active Disk Editor and go to offset 03397XXXX as stated in the statement, we can see a file called “texto - copia.txt”</p>
<p><img alt="alt text" src="../_images/image-351.png" /></p>
<p>Once the file is identified, we simply need to look at the “Flags” on the left and check if it is in use (Exists).</p>
<p>In this case we can certify that the file has been deleted since it is not in use.</p>
<p><img alt="alt text" src="../_images/image-361.png" /></p>
<p>Now we proceed to recover the file data, for this we can close the Active Disk Editor program and open FTK Imager.</p>
<p>Then, click on the icon of the image to start mounting the disk.</p>
<p><img alt="alt text" src="../_images/image-231.png" /></p>
<p>Select the disk, click on “Mount” and verify that the partition appears on the “Mapped Image List”.</p>
<p><img alt="alt text" src="../_images/image-241.png" /></p>
<p>Then, click on the icon of the image to start make an evidence tree.</p>
<p><img alt="alt text" src="../_images/image-251.png" /></p>
<p>Click on “Physical Drive” and continue.</p>
<p><img alt="alt text" src="../_images/image-261.png" /></p>
<p>Select the previously mounted image and finish.</p>
<p><img alt="alt text" src="../_images/image-271.png" /></p>
<p>Verify that and evidence tree appears.</p>
<p><img alt="alt text" src="../_images/image-281.png" /></p>
<p>Click on the folder “carpeta” and find out the filed called “texto - copia.txt” marked with a red cross.
<img alt="alt text" src="../_images/image-291.png" /></p>
<p>Click on said file and click on “Export Files…”</p>
<p><img alt="alt text" src="../_images/image-301.png" />
<img alt="alt text" src="../_images/image-311.png" />
<img alt="alt text" src="../_images/image-321.png" /></p>
<p>Verify that the file has been recovered successfully.</p>
<p><img alt="alt text" src="../_images/image-331.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="section-2">
<h2>Section 2<a class="headerlink" href="#section-2" title="Link to this heading">¶</a></h2>
<section id="id1">
<h3>Statement<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>Identify low-level attributes of one of the files (MFT records) using Active Disk Editor 7. The attributes of interest are <strong>$10</strong>, <strong>$30</strong>, and <strong>$80</strong>.<br />
a. Where can you find the creation, modification, and access dates?<br />
b. What does the <strong>non-resident</strong> property mean, and what are the values 0/1 associated with it?</p>
</section>
<section id="id2">
<h3>Solution<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>Having the <a class="reference download internal" download="" href="../_downloads/60e7072a053c49abae9cb33ae3c6e4c0/disk2.7z"><span class="xref download myst">disk</span></a> imported in Active Disk Editor, select the “FILE0” file and select the NTFS MFT File Record template. With that, we can find out this information:</p>
<p>The <strong>$10</strong> attribute is about Standard information, we will find:</p>
<ul class="simple">
<li><p>The dates of: creation, modification and access.</p></li>
<li><p>The permissions of: owner, security.</p></li>
<li><p>Etc…</p></li>
</ul>
<p><img alt="alt text" src="../_images/image-371.png" /></p>
<p>The <strong>$30</strong> attribute is regarding File Name, therefore there will be information about:</p>
<ul class="simple">
<li><p>The file name</p></li>
<li><p>If it is hidden.</p></li>
<li><p>It is a system file.</p></li>
<li><p>Etc…</p></li>
</ul>
<p><img alt="alt text" src="../_images/image-381.png" /></p>
<p>The <strong>$80</strong> attribute has Data information and we can see:</p>
<ul class="simple">
<li><p>The direct information in the MFT, as long as it is Non-resident (The “Non-resident flag” parameter must be set to 1)</p></li>
</ul>
<p><img alt="alt text" src="../_images/image-391.png" /></p>
<p>Answering the activity, we can find creation, update and file opening information in the $10 attribute. And in case the file is resident, its content can be read directly in the MFT, otherwise it would not be possible.</p>
</section>
</section>
<hr class="docutils" />
<section id="section-3">
<h2>Section 3<a class="headerlink" href="#section-3" title="Link to this heading">¶</a></h2>
<section id="id3">
<h3>Statement<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>Export the <strong>$MFT</strong> metadata file using FTK, process it with MFT2CSV, and import it into a spreadsheet editor to analyze the attributes. The goal is to study which files were deleted and when. Filter by the field <strong>“in use = 0”</strong> (deleted) and/or by <strong>RecordActive = DELETED/ALLOCATED</strong> to obtain the deletion date/time.</p>
</section>
<section id="id4">
<h3>Solution<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>To analyze the MFT, download <a class="reference external" href="https://github.com/jschicht/Mft2Csv">MTF2csv</a>. Once we have it open, we must indicate the path of the volume (explained on <a class="reference internal" href="#section-1"><span class="xref myst">section 1</span></a>) and hard drive from which we extracted the MFT, we will also have to change the separator to be able to read it more comfortably. We must also select the output where it will send the files ourselves.</p>
<p><img alt="alt text" src="../_images/image-401.png" /></p>
<p>Once finished, go to the output area and verify that many files appear there. Open the file inside the red box.</p>
<p><img alt="alt text" src="../_images/image-411.png" /></p>
<p>Open the file using OpenOffice.</p>
<p>Activate some filters by doing the following: Data &gt; Filter &gt; Auto filters. This will let us to analyze the spreadsheet more comfortably. Once this is done, go to column M and select “Deleted”, verify that this two files appear:</p>
<p><img alt="alt text" src="../_images/image-421.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="section-4">
<h2>Section 4<a class="headerlink" href="#section-4" title="Link to this heading">¶</a></h2>
<section id="id5">
<h3>Statement<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>Export the <strong>$LogFILE</strong> metadata file. Together with the $MFT from the previous step, it provides information about file system transactions. Process the files using <strong>NTFSLogFile Parse</strong> to decode the information and obtain a CSV.</p>
<ul class="simple">
<li><p>Search for transactions where <strong>lf_RedoOperation = DeallocateFileRecordSegment</strong> to locate files that were permanently deleted, since this operation deallocates the file record segment.</p></li>
</ul>
</section>
<section id="id6">
<h3>Solution<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>This time, we are going to analyze the $LogFile, in order to do that, select the file and also select the excel sheet that we obtained previously with the MFT extraction. Remember to change the separator to <code class="docutils literal notranslate"><span class="pre">;</span></code>.</p>
<p>After all this, we can click on “Start”.</p>
<p><img alt="alt text" src="../_images/image-431.png" /></p>
<p>Once finished, we can see something like that:</p>
<p><img alt="alt text" src="../_images/image-441.png" /></p>
<p>Now we will analyze the LogFile.csv file, open it using Open Office.</p>
<p><img alt="alt text" src="../_images/image-451.png" /></p>
<p>After establishing some filters, these are the files which have been deleted.</p>
<p><img alt="alt text" src="../_images/image-461.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="section-5">
<h2>Section 5<a class="headerlink" href="#section-5" title="Link to this heading">¶</a></h2>
<section id="id7">
<h3>Statement<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<p>Export the metadata file corresponding to <strong>$USNJournal</strong><br />
(<code class="docutils literal notranslate"><span class="pre">$Extend</span> <span class="pre">-&gt;</span> <span class="pre">$USNjrl</span> <span class="pre">-&gt;</span> <span class="pre">$J</span></code>).<br />
Process it using <strong>UsnJrl2Csv</strong> to decode its stored information.</p>
<ul class="simple">
<li><p>Filter the resulting data by <strong>Reason = CLOSE+DELETE</strong> to obtain the timestamps of permanent file deletions.</p></li>
</ul>
</section>
<section id="id8">
<h3>Solution<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<p>Now we will analyze the $J file, using <a class="reference internal" href="#github.com/jschicht/UsnJrnl2Csv"><span class="xref myst">UsnJrl2Csv</span></a>. Change the separator to <code class="docutils literal notranslate"><span class="pre">;</span></code>, and set the file output path to what we want. After this we will click on “Start”.</p>
<p><img alt="alt text" src="../_images/image-471.png" /></p>
<p>Once finished we can go to the folder we have selected and open the .csv file, with OpenOffice.</p>
<p>Change the separator to <code class="docutils literal notranslate"><span class="pre">;</span></code> and click on accept.</p>
<p><img alt="alt text" src="../_images/image-891.png" /></p>
<p>Add the proper filters in and verify which files have been closed and deleted.</p>
<p><img alt="alt text" src="../_images/image-901.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="section-6">
<h2>Section 6<a class="headerlink" href="#section-6" title="Link to this heading">¶</a></h2>
<section id="id9">
<h3>Statement<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<p>Use the <strong>ANJP</strong> tool to perform a combined analysis of <strong>$MFT</strong>, <strong>$LogFile</strong>, and <strong>$USNJournal</strong>.<br />
You will see that it processes the same information as the previous sections but in an integrated way. It includes a <strong>Parse</strong> tab and a <strong>Report</strong> tab.</p>
<ul class="simple">
<li><p>Use the tool and take a couple of screenshots of the generated report.<br />
<em>(Note: This is a paid tool.)</em></p></li>
</ul>
</section>
<section id="id10">
<h3>Solution<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<p>Now we are going to use the ANJP tool, which combines all the previous tools. For this we must first put a case name, the path where it will leave the files and the files we have used previously.</p>
<p><img alt="alt text" src="../_images/image-481.png" /></p>
<p>Once we have put the paths of all the necessary files, we can click “Parse”, to execute it.</p>
<p><img alt="alt text" src="../_images/image-491.png" /></p>
<p>Once the process is finished, we can go to “Reports”, and view the data obtained from the documents.</p>
<p><img alt="alt text" src="../_images/image-501.png" /></p>
<p>For example, if we access LogFile &gt; File Interactions, we can find relevant information about “texto - copia.txt”</p>
<p><img alt="alt text" src="../_images/image-511.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="section-7">
<h2>Section 7<a class="headerlink" href="#section-7" title="Link to this heading">¶</a></h2>
<section id="id11">
<h3>Statement<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<p>Use <strong>FTK Imager</strong> and <strong>AlternateDataViewer</strong> to study the origin of the files found in the <code class="docutils literal notranslate"><span class="pre">datos.dd</span></code> image.</p>
<ul class="simple">
<li><p>Take a screenshot with each tool showing one example.</p></li>
</ul>
</section>
<section id="id12">
<h3>Solution<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<p>In FTK Imager, deploy the entire Evidence Tree.</p>
<p><img alt="alt text" src="../_images/image-521.png" /></p>
<p>Click over a file as “Proyecto Educativo.pdf”. And study the “Zone.Identifier”.</p>
<p><img alt="alt text" src="../_images/image-531.png" /></p>
<p>If we click tie “Zone.Identifier”, it will show us in plain text a ZoneID, in this example the zone ZoneID is 3, which means that the file has been downloaded from the internet.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ZoneID</p></th>
<th class="head"><p>Security Zone</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>My Computer</p></td>
<td><p>Local machine files</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Local Intranet</p></td>
<td><p>Internal network locations</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Trusted Sites</p></td>
<td><p>Trusted web sites</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Internet</p></td>
<td><p>Files downloaded from the Internet</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Restricted Sites</p></td>
<td><p>Restricted or blocked sites</p></td>
</tr>
</tbody>
</table>
</div>
<p><img alt="alt text" src="../_images/image-541.png" /></p>
<p>Opening AlternateStreamView will look like this:</p>
<p><img alt="alt text" src="../_images/image-551.png" /></p>
<p>As we can see, there are several files and we can analyze their Zone.Identifier, in my case it will be the “ProyectoEducativo.pdf” file. If we double-click on the file, we can obtain the following properties:</p>
<p><img alt="alt text" src="../_images/image-561.png" /></p>
<p>We still need to know where it was downloaded from, so we are going to right-click on it, and we are going to extract the file.</p>
<p><img alt="alt text" src="../_images/image-581.png" /></p>
<p>After that, we will indicate the path where we are going to extract the documents.</p>
<p><img alt="alt text" src="../_images/image-571.png" /></p>
<p>If we open the generated document, we can see the transfer zone, however, the website from which it was downloaded is not shown.</p>
<p><img alt="alt text" src="../_images/image-591.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="section-8">
<h2>Section 8<a class="headerlink" href="#section-8" title="Link to this heading">¶</a></h2>
<section id="id13">
<h3>Statement<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<p>Export the directory index metadata files (<strong>$I30</strong>) for the three directories present in the <code class="docutils literal notranslate"><span class="pre">datos.dd</span></code> disk image:</p>
<ul class="simple">
<li><p>the root directory,</p></li>
<li><p>the directory named “carpeta”,</p></li>
<li><p>and the Recycle Bin directory.<br />
Process these files with <strong>Indx2Csv</strong>.</p></li>
<li><p>Analyze which files exist now and which existed in the past in each directory.</p></li>
</ul>
</section>
<section id="id14">
<h3>Solution<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<p>To extract the files, we must open FTK Imager and mount the evidence tree. Once we have the file located, we will right-click on it and we can extract it wherever we want.</p>
<p><img alt="alt text" src="../_images/image-601.png" />
<img alt="alt text" src="../_images/image-611.png" /></p>
<p>Repeat it with root and the recycle bin folders.</p>
<p><img alt="alt text" src="../_images/image-621.png" />
<img alt="alt text" src="../_images/image-631.png" /></p>
<p>Once we have done this with the three files, we will start using the other tool.</p>
<p>We must configure the launcher with the following parameters:</p>
<p><img alt="alt text" src="../_images/image-641.png" /></p>
<p>A <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file has been generated for each folder. Open them.</p>
<section id="carpeta-folder">
<h4>“Carpeta” Folder<a class="headerlink" href="#carpeta-folder" title="Link to this heading">¶</a></h4>
<p><img alt="alt text" src="../_images/image-651.png" /></p>
<p>In this folder, we can observe a series of 6 pairs, where 3 of them are “texto.txt”, this is because this document has been opened numerous times on different occasions. Thanks to this tool, we can see, for example, the access, creation and deletion time.</p>
</section>
<section id="root-folder">
<h4>Root Folder<a class="headerlink" href="#root-folder" title="Link to this heading">¶</a></h4>
<p><img alt="alt text" src="../_images/image-661.png" /></p>
<p>In this folder, we can not only see the files that are there previously, but we can also see even those hidden files and how they have been modified.</p>
</section>
<section id="papelera-folder">
<h4>“Papelera” Folder<a class="headerlink" href="#papelera-folder" title="Link to this heading">¶</a></h4>
<p><img alt="alt text" src="../_images/image-671.png" /></p>
<p>In this folder, we can observe a large number of documents, as they are all those that have been deleted.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="section-9">
<h2>Section 9<a class="headerlink" href="#section-9" title="Link to this heading">¶</a></h2>
<section id="id15">
<h3>Statement<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<p>Install the automated file recovery tool <strong>Recuva</strong>.<br />
Mount the <code class="docutils literal notranslate"><span class="pre">datos.dd</span></code> disk image with <strong>FTK Imager</strong> and use Recuva to recover as many files as possible.</p>
<ul class="simple">
<li><p>Compare the recovered files with those that FTK Imager is able to recover (marked with the deletion cross icon).</p></li>
</ul>
</section>
<section id="id16">
<h3>Solution<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<p>Now we will use the Recuva program, to be able to recover the lost files we saw previously.</p>
<p>The first thing we will do is show the specific area where those files were located.</p>
<p><img alt="alt text" src="../_images/image-681.png" /></p>
<p>Enable the Deep Scan and click on “Start”</p>
<p><img alt="alt text" src="../_images/image-691.png" /></p>
<p>Delect all the files and click on “Recover”.</p>
<p><img alt="alt text" src="../_images/image-701.png" /></p>
<p>Then it will ask us where we want to leave the files.</p>
<p><img alt="alt text" src="../_images/image-711.png" /></p>
<p>And as we can see, we have been able to recover all these files.</p>
<p><img alt="alt text" src="../_images/image-721.png" /></p>
<p>When comparing the results obtained with Recuva to those obtained using FTK Imager, we can confirm the recovery of the file “calendarioSept2018.pdf” from the root directory and the file “texto - copia.txt” from the “carpeta” directory. For the remaining recovered files, it was not possible to determine their original locations based on the available information.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, PumukyDev
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Exercise 2</a><ul>
<li><a class="reference internal" href="#main-objective-of-the-practice">Main Objective of the Practice</a></li>
<li><a class="reference internal" href="#software-to-use">Software to Use</a></li>
<li><a class="reference internal" href="#section-1">Section 1</a><ul>
<li><a class="reference internal" href="#statement">Statement</a></li>
<li><a class="reference internal" href="#solution">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-2">Section 2</a><ul>
<li><a class="reference internal" href="#id1">Statement</a></li>
<li><a class="reference internal" href="#id2">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-3">Section 3</a><ul>
<li><a class="reference internal" href="#id3">Statement</a></li>
<li><a class="reference internal" href="#id4">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-4">Section 4</a><ul>
<li><a class="reference internal" href="#id5">Statement</a></li>
<li><a class="reference internal" href="#id6">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-5">Section 5</a><ul>
<li><a class="reference internal" href="#id7">Statement</a></li>
<li><a class="reference internal" href="#id8">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-6">Section 6</a><ul>
<li><a class="reference internal" href="#id9">Statement</a></li>
<li><a class="reference internal" href="#id10">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-7">Section 7</a><ul>
<li><a class="reference internal" href="#id11">Statement</a></li>
<li><a class="reference internal" href="#id12">Solution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#section-8">Section 8</a><ul>
<li><a class="reference internal" href="#id13">Statement</a></li>
<li><a class="reference internal" href="#id14">Solution</a><ul>
<li><a class="reference internal" href="#carpeta-folder">“Carpeta” Folder</a></li>
<li><a class="reference internal" href="#root-folder">Root Folder</a></li>
<li><a class="reference internal" href="#papelera-folder">“Papelera” Folder</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#section-9">Section 9</a><ul>
<li><a class="reference internal" href="#id15">Statement</a></li>
<li><a class="reference internal" href="#id16">Solution</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=01f34227"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>